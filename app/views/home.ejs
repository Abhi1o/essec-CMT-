<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Court-Mais-Trash (CMT) - ESSEC</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
    :root {
            --primary-color: #3A86FF;
            --secondary-color: #8338EC;
            --accent-color: #FF006E;
            --background-color: #F8F9FA;
            --text-color: #212529;
            --card-background: #FFFFFF;
            --shadow-color: rgba(0, 0, 0, 0.1);
            --input-border: #CED4DA;
            --button-color: #3A86FF;
            --tab-inactive: #E9ECEF;
            --success-color: #38B000;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--text-color);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            background: linear-gradient(120deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 6px var(--shadow-color);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        nav ul {
            display: flex;
            gap: 20px;
            list-style-type: none;
        }

        nav a {
            color: white;
            text-decoration: none;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        nav a:hover {
            color: var(--accent-color);
        }

        .hero {
            background: linear-gradient(rgba(58, 134, 255, 0.8), rgba(131, 56, 236, 0.8)), url('https://source.unsplash.com/random/1600x900/?university') no-repeat center center/cover;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
            padding: 0 20px;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
        }

        .hero-content {
            position: relative;
            z-index: 1;
        }

        .hero h1 {
            font-size: 48px;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .hero p {
            font-size: 20px;
            max-width: 600px;
            margin: 0 auto 30px;
        }

        .btn {
            background: linear-gradient(120deg, var(--accent-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 18px;
            cursor: pointer;
            border-radius: 30px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(120deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: all 0.4s ease;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .search-container {
            display: flex;
            justify-content: center;
            margin: 50px 0;
        }

        .search-input {
            width: 60%;
            padding: 15px 20px;
            font-size: 16px;
            border-radius: 30px;
            border: none;
            box-shadow: 0 4px 6px var(--shadow-color);
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            box-shadow: 0 6px 8px var(--shadow-color);
            width: 65%;
        }

        .tabs {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .tab-btn {
            background: linear-gradient(120deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 18px;
            cursor: pointer;
            border-radius: 30px;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .tab-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px var(--shadow-color);
        }

        .tab-btn.active {
            background: linear-gradient(120deg, var(--accent-color), var(--secondary-color));
        }

        .card-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }

        .card {
            background-color: var(--card-background);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 20px var(--shadow-color);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px var(--shadow-color);
        }

        .card-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        .card-info {
            font-size: 16px;
            color: #6c757d;
            margin-bottom: 10px;
        }

        .chart-container {
            background-color: var(--card-background);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 20px var(--shadow-color);
            margin-bottom: 50px;
        }

        .chart-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--primary-color);
            text-align: center;
        }

        .about-cmt {
            background-color: var(--card-background);
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 10px 20px var(--shadow-color);
            margin-bottom: 50px;
        }

        .about-cmt h2 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--primary-color);
        }

        .about-cmt p {
            font-size: 16px;
            margin-bottom: 15px;
            color: #495057;
        }

        footer {
            background: linear-gradient(120deg, var(--primary-color), var(--secondary-color));
            color: white;
            text-align: center;
            padding: 30px 0;
            margin-top: 50px;
        }

        #scrollToTopBtn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            font-size: 24px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            display: none;
            transition: all 0.3s ease;
        }

        #scrollToTopBtn:hover {
            background-color: var(--secondary-color);
        }

        @media (max-width: 768px) {
            .hero h1 {
                font-size: 36px;
            }

            .hero p {
                font-size: 18px;
            }

            .search-input {
                width: 80%;
            }

            .card-container {
                grid-template-columns: 1fr;
            }
        }
    </style>

</head>
<body>
    <header>
        <div class="container header-content">
            <div class="logo">
                <i class="fas fa-graduation-cap"></i>
                CMT
            </div>
            <nav>
                <ul>
                    <li><a href="#"><i class="fas fa-search"></i> Rechercher</a></li>
                    <li><a href="/cours"><i class="fas fa-book"></i> Cours</a></li>
                    <li><a href="/profs"><i class="fas fa-user"></i> Profs</a></li>
                    <li><a href="/signout"><i class="fas fa-sign-out-alt"></i> Déconnexion</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <div class="language-selector">
        <select id="language-select" onchange="changeLanguage()">
            <option value="fr">Français</option>
            <option value="en">English</option>
        </select>
    </div>

    <main class="container">
        <section class="hero">
            <h1>Bienvenue sur Court-Mais-Trash!</h1>
            <p>Découvrez les meilleurs cours et professeurs de l'ESSEC, évalués par vos pairs</p>
            <button class="btn" onclick="location.href='/cours'">Commencer l'exploration</button>
        </section>

        <div class="search-container">
            <input type="text" class="search-input" placeholder="Rechercher un cours ou un professeur..." id="searchInput">
        </div>

        <section class="tabs">
            <button class="tab-btn active" data-tab="courses">Les cours les mieux notés</button>
            <button class="tab-btn" data-tab="professors">Les profs les mieux notés</button>
        </section>

        <section class="card-container" id="cardContainer"></section>

        <section class="chart-container">
            <h2 class="chart-title">Analyse des départements</h2>
            <canvas id="myChart"></canvas>
        </section>

        <section class="about-cmt">
            <h2>À propos de Court-Mais-Trash</h2>
            <p>Le Court-Mais-Trash (ou CMT pour les intimes) est une plateforme qui regroupe l'ensemble des avis des étudiants de la Grande École de l'ESSEC sur les différents cours dispensés.</p>
            <p>Il est parfois difficile de faire son choix dans un catalogue de plus de 200 cours. C'est pourquoi le BDE ESSEC s'active chaque année pour récupérer un maximum d'avis, pour que tu puisses faire ton choix plus aisément.</p>
            <p>Il faut savoir que le CMT n'est pas officiel. Les avis qui sont récoltés ici ne proviennent pas de l'administration. Donc pas de langue de bois, tu t'exprimes comme tu le souhaites (toujours dans le respect d'autrui).</p>
            <p>De plus, nous t'invitons bien évidemment à mettre tes avis. Venir récupérer des infos c'est bien, mais en donner soit même c'est pas mal aussi. Pas de panique, tout est anonyme !</p>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>© 2024 Court-Mais-Trash. Tous droits réservés.</p>
            <p>Développé avec passion par BDE Havana</p>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io.connect('http://vps-d12f2153.vps.ovh.net:80');
        let activeTab = 'courses';
        const cardContainer = document.getElementById('cardContainer');
        const searchInput = document.getElementById('searchInput');
        const tabButtons = document.querySelectorAll('.tab-btn');

        let bestCourses = [];
        let worstCourses = [];
        let bestProfs = [];
        let worstProfs = [];

        function renderCards(data) {
            cardContainer.innerHTML = '';
            data.forEach((item, index) => {
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <h3 class="card-title">${item._id.CodeCours ? `${item._id.CodeCours} - ${item._id.NomCours}` : item._id}</h3>
                    <p class="card-info"><i class="fas fa-star"></i> Note: ${(item.moyenneCours || item.moyenneProf).toFixed(1)}</p>
                    <p class="card-info"><i class="fas fa-comments"></i> Avis: ${item.nbAvis}</p>
                `;
                cardContainer.appendChild(card);
            });
        }

        function filterData(data, searchTerm) {
            return data.filter(item => 
                (item._id.NomCours && item._id.NomCours.toLowerCase().includes(searchTerm.toLowerCase())) ||
                (item._id.CodeCours && item._id.CodeCours.toLowerCase().includes(searchTerm.toLowerCase())) ||
                (typeof item._id === 'string' && item._id.toLowerCase().includes(searchTerm.toLowerCase()))
            );
        }

        searchInput.addEventListener('input', () => {
            const searchTerm = searchInput.value;
            const filteredData = filterData(activeTab === 'courses' ? bestCourses : bestProfs, searchTerm);
            renderCards(filteredData);
        });

        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                activeTab = button.dataset.tab;
                tabButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                renderCards(activeTab === 'courses' ? bestCourses : bestProfs);
            });
        });

        socket.emit('requestBestCourses');
        socket.emit('requestWorstCourses');
        socket.emit('requestBestProfs');
        socket.emit('requestWorstProfs');

        socket.on('responseBestCourses', function(data) {
            bestCourses = data;
            renderCards(bestCourses);
        });

        socket.on('responseWorstCourses', function(data) {
            worstCourses = data;
        });

        socket.on('responseBestProfs', function(data) {
            bestProfs = data;
        });

        socket.on('responseWorstProfs', function(data) {
            worstProfs = data;
        });

        // Initialize chart
        const ctx = document.getElementById('myChart').getContext('2d');
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Marketing', 'Finance', 'Management', 'Economics', 'IT'],
                datasets: [
                    {
                        label: 'Note moyenne',
                        data: [8.8, 8.6, 8.5, 8.7, 8.9],
                        backgroundColor: 'rgba(66, 133, 244, 0.7)',
                        borderColor: 'rgba(66, 133, 244, 1)',
                        borderWidth: 1
                    },
                    {
                        label: 'Nombre de cours',
                        data: [25, 20, 18, 15, 12],
                        backgroundColor: 'rgba(234, 67, 53, 0.7)',
                        borderColor: 'rgba(234, 67, 53, 1)',
                        borderWidth: 1
                    }
                ]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true
                    }
                },
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    title: {
                        display: true,
                        text: 'Analyse des départements'
                    }
                }
            }
        });

        // Language switching functionality
        function changeLanguage() {
            const lang = document.getElementById('language-select').value;
            if (lang === 'en') {
                // Change text to English
                document.querySelector('.hero h1').textContent = 'Welcome to Court-Mais-Trash!';
                document.querySelector('.hero p').textContent = 'Discover the best courses and professors at ESSEC, rated by your peers';
                document.querySelector('.hero .btn').textContent = 'Start Exploring';
                document.querySelector('.search-input').placeholder = 'Search for a course or professor...';
                document.querySelectorAll('.tab-btn')[0].textContent = 'Top Rated Courses';
                document.querySelectorAll('.tab-btn')[1].textContent = 'Top Rated Professors';
                // ... add more translations as needed
            } else {
                // Change text back to French
                document.querySelector('.hero h1').textContent = 'Bienvenue sur Court-Mais-Trash!';
                document.querySelector('.hero p').textContent = 'Découvrez les meilleurs cours et professeurs de l\'ESSEC, évalués par vos pairs';
                document.querySelector('.hero .btn').textContent = 'Commencer l\'exploration';
                document.querySelector('.search-input').placeholder = 'Rechercher un cours ou un professeur...';
                document.querySelectorAll('.tab-btn')[0].textContent = 'Les cours les mieux notés';
                document.querySelectorAll('.tab-btn')[1].textContent = 'Les profs les mieux notés';
                // ... add more translations as needed
            }
        }
    </script>
</body>
</html>